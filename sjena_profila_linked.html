<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="UTF-8">
<title>Sjena profila – LIVE MIG</title>

<style>
body{
    background:#0e0e0e;
    color:#eee;
    font-family:Arial;
}
.container{
    width:750px;
    margin:30px auto;
    background:#1d1d1d;
    padding:20px;
    border-radius:14px;
    box-shadow:0 0 30px #000;
}
h2{text-align:center;color:#ff3b3b}

.controls{
    display:flex;
    justify-content:space-between;
}
.controls div{
    width:30%;
}
input{width:100%}

canvas{
    background:#222;
    display:block;
    margin:20px auto;
    border-radius:8px;
}

.info{
    background:#000;
    padding:10px;
    border-radius:6px;
}
.alert{
    color:#ff4444;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="container">
<h2>SJENA PROFILA – LIVE IZ QUICKMIG-a</h2>

<div class="controls">
<div>
Debljina profila (mm)
<input type="range" min="1" max="4" step="0.5" value="2"
oninput="th=this.value;draw()">
<span id="th">2</span>
</div>

<div>
Induktivnost (sa aparata)
<div id="ind">5</div>
</div>

<div>
Status
<div id="status">Povezano</div>
</div>
</div>

<canvas id="c" width="650" height="280"></canvas>

<div class="info">
Žica: <b><span id="w">0</span> m/min</b><br>
Napon: <b><span id="v">0</span> V</b><br>
Toplotni unos: <b><span id="heat">0</span></b><br>
Širina sjene (HAZ): <b><span id="s">0</span> mm</b><br>
<span id="warn"></span>
</div>

</div>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");

let th = 2;

function draw(){
    let data = localStorage.getItem("quickmig");
    if(!data){
        status.innerText="NEMA PODATAKA";
        return;
    }

    let d = JSON.parse(data);
    w.innerText = d.wire;
    v.innerText = d.volt;
    ind.innerText = d.ind;

    // REALNI MIG toplinski unos
    let heat = (d.wire * d.volt * (1 + d.ind/20));
    heat = heat.toFixed(1);
    heatSpan = document.getElementById("heat");
    heatSpan.innerText = heat;

    // HAZ aproksimacija
    let shadow = (heat / (th * 35)).toFixed(1);
    s.innerText = shadow;

    // upozorenje
    warn.innerText = shadow > th*1.2 ?
        "⚠ PREVELIKA TOPLOTA – MOGUĆE KRIVLJENJE" : "";

    ctx.clearRect(0,0,c.width,c.height);

    let px=150, py=100, pw=350, ph=th*15;

    // sjena
    ctx.fillStyle="rgba(255,80,0,0.28)";
    ctx.fillRect(px-shadow*5, py-shadow*2,
                 pw+shadow*10, ph+shadow*4);

    // var
    ctx.fillStyle="#ff6a00";
    ctx.fillRect(px, py+ph/2-3, pw, 6);

    // profil
    ctx.fillStyle="#888";
    ctx.fillRect(px, py, pw, ph);

    ctx.fillStyle="#aaa";
    ctx.fillText("ČELIČNI PROFIL", px+120, py-10);
}

// LIVE update
setInterval(draw, 400);
</script>

</body>
</html>
